# ğŸ§  NLPæ¨¡å—å·¥ä½œè¯¦è§£

> è´Ÿè´£äººï¼šNLPæ¨¡å—å¼€å‘
> æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»æ™ºèƒ½åŒ»ç–—è¯­éŸ³åŠ©æ‰‹ç³»ç»Ÿä¸­ NLPï¼ˆè‡ªç„¶è¯­è¨€å¤„ç†ï¼‰æ¨¡å—çš„è®¾è®¡ã€å®ç°å’ŒæŠ€æœ¯ç»†èŠ‚ã€‚

---

## ğŸ“‹ æ¨¡å—æ€»è§ˆ

NLPæ¨¡å—æ˜¯ç³»ç»Ÿçš„"å¤§è„‘"ï¼Œè´Ÿè´£ç†è§£ç”¨æˆ·æ„å›¾ã€æ£€ç´¢åŒ»ç–—çŸ¥è¯†ã€ç”Ÿæˆä¸“ä¸šå›å¤ã€‚ä¸»è¦åŒ…å«ä»¥ä¸‹æ ¸å¿ƒç»„ä»¶ï¼š

| ç»„ä»¶ | åŠŸèƒ½ | æ ¸å¿ƒæŠ€æœ¯ |
|:---|:---|:---|
| **å¯¹è¯ç³»ç»Ÿ (LLM)** | ç†è§£è¯­ä¹‰ã€ç”Ÿæˆå›å¤ | Qwenç³»åˆ—æ¨¡å‹ (0.5B/4B/8B) |
| **RAGçŸ¥è¯†æ£€ç´¢** | å‘é‡æ£€ç´¢ã€çŸ¥è¯†å¢å¼º | FAISS + BGE Embedding |
| **çŸ¥è¯†å›¾è°±** | ç»“æ„åŒ–åŒ»å­¦çŸ¥è¯†é—®ç­” | Neo4j + åŒ»å­¦è¯å…¸ |
| **ä½¿ç”¨åœºæ™¯** | å¤šè§’è‰²å·®å¼‚åŒ–æœåŠ¡ | æ‚£è€…/åŒ»ç”Ÿ/ä¼šè¯Š/é™ªæŠ¤ |

---

## ğŸ¤– ä¸€ã€å¯¹è¯ç³»ç»Ÿ - ä¸‰ç§LLMæ–¹æ¡ˆ

### æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | æ¨¡å‹ | é‡åŒ–æ–¹å¼ | æ˜¾å­˜å ç”¨ | éƒ¨ç½²åœºæ™¯ |
|:---|:---|:---:|:---:|:---|
| **æ–¹æ¡ˆä¸€** | Qwen2.5-0.5B-Instruct | FP16 | ~1GB | èµ„æºå—é™ç¯å¢ƒ |
| **æ–¹æ¡ˆäºŒ** | Qwen3-4B | GGUF Q4_K_M | ~3GB | MacOS (Metal) |
| **æ–¹æ¡ˆä¸‰** | Qwen3-8B-SFT-Huatuo | GPTQ W4A16 | ~6GB | GPUæœåŠ¡å™¨ (ç”Ÿäº§) |

---

### æ–¹æ¡ˆä¸€ï¼šQwen2.5-0.5B-Instructï¼ˆè½»é‡çº§ï¼‰

**æ–‡ä»¶ä½ç½®**: `server/modules/core/dialogue.py`

**æŠ€æœ¯ç‰¹ç‚¹**:
- å‚æ•°é‡ 5äº¿ï¼Œä»…éœ€ ~1GB æ˜¾å­˜
- ä½¿ç”¨ Transformers åŸç”ŸåŠ è½½
- æ”¯æŒ CPU / GPU / MPS å¤šå¹³å°

**æ ¸å¿ƒå®ç°**:

```python
class DialogueModule:
    def __init__(self, model_name="Qwen/Qwen2.5-0.5B-Instruct", 
                 device="cuda", max_length=512, temperature=0.7, 
                 top_p=0.9, history_length=10, rag_module=None):
        # æ¨¡å‹åŠ è½½ï¼šæ”¯æŒ ModelScope / HuggingFace
        # è‡ªåŠ¨è®¾å¤‡æ£€æµ‹ï¼šcuda > mps > cpu
        # å¤šè½®å¯¹è¯å†å²ç®¡ç†
        
    def chat(self, query, session_id="default", 
             system_prompt=None, emotion=None, use_rag=True):
        # 1. RAG çŸ¥è¯†æ£€ç´¢å¢å¼º
        # 2. å¤šè½®å¯¹è¯å†å²æ‹¼æ¥
        # 3. æƒ…æ„Ÿæ„ŸçŸ¥æ¨¡å¼æ”¯æŒ
        # 4. TTS åå¤„ç†ä¼˜åŒ–
```

**å…³é”®åŠŸèƒ½**:
- **RAGé›†æˆ**: è‡ªåŠ¨æ£€ç´¢ç›¸å…³çŸ¥è¯†ï¼Œå¢å¼ºå›å¤è´¨é‡
- **æƒ…æ„Ÿæ„ŸçŸ¥**: é›†æˆ `EmotionResponseStrategy` æ¨¡å—
- **TTSä¼˜åŒ–**: `_clean_for_tts()` å»é™¤ä¸é€‚åˆè¯­éŸ³åˆæˆçš„ç¬¦å·
- **ä¼šè¯ç®¡ç†**: åŸºäº `session_id` çš„å¤šä¼šè¯å¹¶è¡Œæ”¯æŒ

---

### æ–¹æ¡ˆäºŒï¼šQwen3-4B GGUFï¼ˆMac MetalåŠ é€Ÿï¼‰

**æ–‡ä»¶ä½ç½®**: `server/modules/core/gguf_dialogue.py`

**æŠ€æœ¯ç‰¹ç‚¹**:
- ä½¿ç”¨ `llama-cpp-python` åŠ è½½ GGUF æ ¼å¼
- Q4_K_M é‡åŒ–ï¼š4-bit æƒé‡ï¼Œæ¨¡å‹ä½“ç§¯é™è‡³çº¦ 2.5GB
- Mac Metal GPU åŠ é€Ÿæ¨ç†

**æ ¸å¿ƒå®ç°**:

```python
class GGUFDialogueModule:
    def __init__(self, model_path, n_ctx=4096, n_threads=4,
                 n_gpu_layers=-1, temperature=0.7, top_p=0.9):
        # llama.cpp åŠ è½½ GGUF æ ¼å¼
        # n_gpu_layers=-1 è¡¨ç¤ºå…¨éƒ¨å±‚ä½¿ç”¨ GPU
        
    def chat(self, query, session_id="default", use_rag=True):
        # Qwen3 ç‰¹æ®Šå¤„ç†ï¼šç§»é™¤ <think>...</think> æ€è€ƒå†…å®¹
        think_pattern = r'<think>.*?</think>\s*'
        clean_message = re.sub(think_pattern, '', response, flags=re.DOTALL)
```

**GGUFæ¨¡å‹ä¸‹è½½**:
```python
def download_gguf_model(repo, filename, target_dir, source="modelscope"):
    # æ”¯æŒ HuggingFace / ModelScope ä¸¤ä¸ªä¸‹è½½æº
    # è‡ªåŠ¨ç¼“å­˜å·²ä¸‹è½½æ¨¡å‹
```

---

### æ–¹æ¡ˆä¸‰ï¼šQwen3-8B GPTQï¼ˆç”Ÿäº§æ¨èï¼‰â­

**æ–‡ä»¶ä½ç½®**: `server/modules/core/gptq_dialogue.py`

**æŠ€æœ¯ç‰¹ç‚¹**:
- **åŒ»ç–—å¾®è°ƒ**: SFT on Huatuo åŒ»ç–—æ•°æ®é›†
- **GPTQé‡åŒ–**: W4A16ï¼ˆ4-bitæƒé‡ï¼Œ16-bitæ¿€æ´»ï¼‰
- **æ˜¾å­˜èŠ‚çœ**: ç›¸æ¯”FP16å‡å°‘çº¦75%æ˜¾å­˜

**æ ¸å¿ƒå®ç°**:

```python
class GPTQDialogueModule:
    def __init__(self, model_path, device="cuda", max_length=512,
                 temperature=0.7, top_p=0.9, history_length=10):
        # transformers 4.33+ åŸç”Ÿæ”¯æŒ GPTQ
        self.model = AutoModelForCausalLM.from_pretrained(
            model_path,
            trust_remote_code=True,
            device_map="auto"  # è‡ªåŠ¨åˆ†é… GPU
        )
```

**é‡åŒ–ä¼˜åŠ¿**:

| æŒ‡æ ‡ | FP16 | GPTQ W4A16 |
|:---|:---:|:---:|
| æ¨¡å‹ä½“ç§¯ | 16GB | 4GB |
| æ˜¾å­˜å ç”¨ | 16GB+ | ~6GB |
| æ¨ç†é€Ÿåº¦ | åŸºå‡† | ç¨å¿« |
| ç²¾åº¦æŸå¤± | 0% | <1% |

---

### ä¸‰ç§æ–¹æ¡ˆçš„é…ç½®åˆ‡æ¢

**é…ç½®æ–‡ä»¶**: `config/config.yaml`

```yaml
dialogue:
  # æ¨¡å‹æä¾›è€…: transformers, gguf, gptq
  provider: "gptq"  # åˆ‡æ¢æ­¤é¡¹å³å¯
  
  # GPTQ é…ç½®
  gptq_model_path: "server/models/gptq/qwen3-8b-sft-huatuo-quant-w4a16"
  
  # GGUF é…ç½®  
  gguf_repo: "Qwen/Qwen3-4B-GGUF"
  gguf_file: "qwen3-4b-q4_k_m.gguf"
  gguf_source: "modelscope"
  
  # Transformers é…ç½®
  model: "Qwen/Qwen2.5-0.5B-Instruct"
```

---

## ğŸ“š äºŒã€RAGçŸ¥è¯†æ£€ç´¢ç³»ç»Ÿ

### ç³»ç»Ÿæ¶æ„

```
ç”¨æˆ·æŸ¥è¯¢ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        RAG æ£€ç´¢å¢å¼ºç³»ç»Ÿ                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚  1. çŸ¥è¯†å›¾è°±æŸ¥è¯¢  â”‚ â”€â”€â”€ä¼˜å…ˆâ”€â”€â–ºâ”‚  Neo4j æ™ºèƒ½é—®ç­”  â”‚                  â”‚
â”‚   â”‚   (Smart Query)  â”‚          â”‚  (å¦‚æœå‘½ä¸­åˆ™è¿”å›) â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚           â”‚                             â”‚                            â”‚
â”‚       æœªå‘½ä¸­                          å‘½ä¸­                            â”‚
â”‚           â”‚                             â–¼                            â”‚
â”‚           â–¼                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚  è¿”å›å›¾è°±çŸ¥è¯†    â”‚                  â”‚
â”‚   â”‚  2. å‘é‡æ£€ç´¢     â”‚          â”‚  è·³è¿‡å‘é‡æ£€ç´¢    â”‚                  â”‚
â”‚   â”‚   (FAISS)       â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚
â”‚           â”‚                                                          â”‚
â”‚           â–¼                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚
â”‚   â”‚ BGE Embedding   â”‚                                               â”‚
â”‚   â”‚ ç›¸ä¼¼åº¦è®¡ç®—       â”‚                                               â”‚
â”‚   â”‚ Top-K æ£€ç´¢      â”‚                                               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚
â”‚           â”‚                                                          â”‚
â”‚           â–¼                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚
â”‚   â”‚ æ‹¼æ¥ä¸º Context  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  LLM ç”Ÿæˆ  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

**æ–‡ä»¶ä½ç½®**: `server/modules/core/rag.py`

#### 1. Embeddingæ¨¡å‹

```python
# ä½¿ç”¨ BGE ä¸­æ–‡å‘é‡æ¨¡å‹
embedding_model = "BAAI/bge-small-zh-v1.5"
# å‘é‡ç»´åº¦ï¼š512
# æ”¯æŒ ModelScope é•œåƒä¸‹è½½
```

#### 2. FAISSå‘é‡ç´¢å¼•

```python
class RAGModule:
    def __init__(self, embedding_model, index_path, top_k=3, min_score=0.5):
        # ä½¿ç”¨ FAISS IndexFlatIPï¼ˆå†…ç§¯ä½™å¼¦ç›¸ä¼¼åº¦ï¼‰
        self.index = faiss.IndexFlatIP(self.embedding_dim)
        
    def retrieve(self, query, top_k=None):
        # 1. æŸ¥è¯¢å‘é‡åŒ–
        query_embedding = self.model.encode([query], normalize_embeddings=True)
        # 2. FAISS æ£€ç´¢
        scores, indices = self.index.search(query_embedding, top_k)
        # 3. ç›¸ä¼¼åº¦é˜ˆå€¼è¿‡æ»¤
        if score < self.min_score:
            continue  # è¿‡æ»¤ä½è´¨é‡ç»“æœ
```

#### 3. çŸ¥è¯†å›¾è°±ä¼˜å…ˆç­–ç•¥

```python
def build_context(self, query, top_k=None):
    """å›¾è°±ä¼˜å…ˆ + å‘é‡å…œåº•"""
    
    # 1. ä¼˜å…ˆæŸ¥è¯¢çŸ¥è¯†å›¾è°±
    if self.knowledge_graph and self.knowledge_graph.enabled:
        kg_context = self.knowledge_graph.build_context_from_query(query)
        if kg_context:
            print("[RAGå†³ç­–] âœ… çŸ¥è¯†å›¾è°±å‘½ä¸­ï¼Œè·³è¿‡å‘é‡æ£€ç´¢")
            return f"ã€åŒ»å­¦çŸ¥è¯†åº“ã€‘\n{kg_context}"
    
    # 2. å›¾è°±æ— ç»“æœï¼Œä½¿ç”¨å‘é‡æ£€ç´¢
    retrieved = self.retrieve(query, top_k)
    if retrieved:
        print(f"[RAGå†³ç­–] â„¹ çŸ¥è¯†å›¾è°±æ— ç»“æœï¼Œå‘é‡æ£€ç´¢å‘½ä¸­ {len(retrieved)} æ¡")
        return self._format_context(retrieved)
```

### çŸ¥è¯†åº“æ•°æ®æ¥æº

**æ•°æ®çˆ¬å–**: å¤ç”¨ `chatbot-base-on-Knowledge-Graph-master` é¡¹ç›®çš„çˆ¬è™«

| æ•°æ®ç±»å‹ | æ•°é‡ | æ¥æº |
|:---|:---:|:---|
| RAGæ–‡æ¡£ | 177,703 ç¯‡ | åŒ»ç–—é—®ç­”ã€ç–¾ç—…ç™¾ç§‘ |
| çŸ¥è¯†å›¾è°±å®ä½“ | 44,093 ä¸ª | ç–¾ç—…ã€ç—‡çŠ¶ã€è¯ç‰©ã€é£Ÿç‰© |

---

## ğŸŒ ä¸‰ã€çŸ¥è¯†å›¾è°±ç³»ç»Ÿ

### ç³»ç»Ÿæ¶æ„

**æ–‡ä»¶ä½ç½®**: `server/modules/knowledge/knowledge_graph.py`

```
ç”¨æˆ·é—®é¢˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      çŸ¥è¯†å›¾è°±æ™ºèƒ½é—®ç­”æµç¨‹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚ åŒ»å­¦è¯å…¸     â”‚â”€â”€â”€â–ºâ”‚ æ„å›¾åˆ†ç±»å™¨   â”‚â”€â”€â”€â–ºâ”‚ Cypherç”Ÿæˆå™¨â”‚            â”‚
â”‚   â”‚ ACè‡ªåŠ¨æœº    â”‚    â”‚ è§„åˆ™+å…³é”®è¯  â”‚    â”‚ åŠ¨æ€SQLæ„å»º â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚         â”‚                   â”‚                   â”‚                    â”‚
â”‚         â–¼                   â–¼                   â–¼                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚ å®ä½“è¯†åˆ«     â”‚    â”‚ æ„å›¾åˆ¤æ–­     â”‚    â”‚ æ‰§è¡ŒæŸ¥è¯¢     â”‚            â”‚
â”‚   â”‚ ç–¾ç—…/ç—‡çŠ¶/è¯ç‰©â”‚    â”‚ 13ç§åŒ»å­¦æ„å›¾ â”‚    â”‚ Neo4j Graph â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                 â”‚                    â”‚
â”‚                                                 â–¼                    â”‚
â”‚                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚                                         â”‚ ç»“æœæ ¼å¼åŒ–   â”‚            â”‚
â”‚                                         â”‚ æ„å»ºä¸Šä¸‹æ–‡   â”‚            â”‚
â”‚                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

#### 1. åŒ»å­¦è¯å…¸ (ACè‡ªåŠ¨æœº)

**æ–‡ä»¶ä½ç½®**: `server/modules/medical/medical_dict.py`

```python
class MedicalDictionary:
    """åŸºäº AC è‡ªåŠ¨æœºçš„é«˜æ•ˆåŒ»å­¦å®ä½“è¯†åˆ«"""
    
    # æ”¯æŒçš„å®ä½“ç±»å‹
    ENTITY_TYPES = ['disease', 'symptom', 'drug', 'check', 'food', 'department']
    
    def __init__(self, dict_dir):
        # åŠ è½½è¯å…¸æ–‡ä»¶ï¼šdisease.txt, symptom.txt, drug.txt...
        # æ„å»º AC è‡ªåŠ¨æœºï¼ˆä¸€æ¬¡æ„å»ºï¼ŒO(n) æŸ¥è¯¢ï¼‰
        
    def extract_entities(self, text):
        # è¿”å›: {
        #   'disease': ['æ„Ÿå†’', 'å‘çƒ§'],
        #   'symptom': ['å¤´ç—›', 'å’³å—½'],
        #   'drug': ['å¸ƒæ´›èŠ¬'],
        #   ...
        # }
```

**è¯å…¸è§„æ¨¡**:

| è¯å…¸ | è¯æ¡æ•° | ç¤ºä¾‹ |
|:---|:---:|:---|
| disease.txt | ~8,000 | æ„Ÿå†’ã€é«˜è¡€å‹ã€ç³–å°¿ç—… |
| symptom.txt | ~5,000 | å¤´ç—›ã€å‘çƒ­ã€å’³å—½ |
| drug.txt | ~4,000 | é˜¿è«è¥¿æ—ã€å¸ƒæ´›èŠ¬ |
| check.txt | ~500 | è¡€å¸¸è§„ã€CTã€Bè¶… |
| food.txt | ~3,000 | è¥¿ç“œã€ç‰›å¥¶ã€é¸¡è›‹ |
| department.txt | ~50 | å†…ç§‘ã€å¤–ç§‘ã€å„¿ç§‘ |

#### 2. æ„å›¾åˆ†ç±»å™¨

**æ–‡ä»¶ä½ç½®**: `server/modules/medical/intent_classifier.py`

```python
class IntentClassifier:
    """åŸºäºè§„åˆ™å’Œå…³é”®è¯çš„åŒ»å­¦æ„å›¾åˆ†ç±»"""
    
    # æ”¯æŒçš„13ç§åŒ»å­¦æ„å›¾
    INTENTS = {
        'disease_symptom':     'æŸ¥è¯¢ç–¾ç—…çš„ç—‡çŠ¶',
        'symptom_disease':     'æ ¹æ®ç—‡çŠ¶æ¨æ–­ç–¾ç—…',
        'disease_drug':        'æŸ¥è¯¢ç–¾ç—…çš„ç”¨è¯',
        'drug_disease':        'æŸ¥è¯¢è¯ç‰©å¯æ²»ç–—çš„ç–¾ç—…',
        'disease_food':        'æŸ¥è¯¢ç–¾ç—…çš„é¥®é£Ÿå»ºè®®',
        'disease_not_food':    'æŸ¥è¯¢ç–¾ç—…çš„é¥®é£Ÿç¦å¿Œ',
        'disease_check':       'æŸ¥è¯¢ç–¾ç—…éœ€è¦çš„æ£€æŸ¥',
        'disease_cause':       'æŸ¥è¯¢ç–¾ç—…çš„ç—…å› ',
        'disease_prevent':     'æŸ¥è¯¢ç–¾ç—…çš„é¢„é˜²æ–¹æ³•',
        'disease_cureway':     'æŸ¥è¯¢ç–¾ç—…çš„æ²»ç–—æ–¹å¼',
        'disease_desc':        'æŸ¥è¯¢ç–¾ç—…çš„è¯¦ç»†æè¿°',
        'disease_department':  'æŸ¥è¯¢ç–¾ç—…åº”æŒ‚ä»€ä¹ˆç§‘',
        'disease_acompany':    'æŸ¥è¯¢ç–¾ç—…çš„å¹¶å‘ç—‡',
    }
    
    def classify(self, query, entities):
        # åŸºäºå…³é”®è¯å’Œå®ä½“ç»„åˆåˆ¤æ–­æ„å›¾
        # è¿”å›: (intent, confidence)
```

#### 3. Cypherç”Ÿæˆå™¨

**æ–‡ä»¶ä½ç½®**: `server/modules/knowledge/cypher_generator.py`

```python
class CypherGenerator:
    """åŠ¨æ€ç”Ÿæˆ Neo4j Cypher æŸ¥è¯¢è¯­å¥"""
    
    def generate(self, intent, entities):
        # æ ¹æ®æ„å›¾å’Œå®ä½“åŠ¨æ€æ„å»º Cypher
        
        if intent == 'disease_symptom':
            disease = entities.get('disease', [])
            return f"""
                MATCH (d:Disease)-[:has_symptom]->(s:Symptom)
                WHERE d.name IN {disease}
                RETURN d.name as disease, collect(s.name) as symptoms
            """
        
        elif intent == 'drug_disease':
            drug = entities.get('drug', [])
            return f"""
                MATCH (d:Disease)-[:common_drug|recommand_drug]->(drug:Drug)
                WHERE drug.name IN {drug}
                RETURN drug.name as drug, collect(d.name) as diseases
            """
```

#### 4. çŸ¥è¯†å›¾è°±ç»“æ„

```
Neo4j å›¾æ•°æ®åº“ç»“æ„

èŠ‚ç‚¹ç±»å‹ (Node Labels):
â”œâ”€â”€ Disease    (ç–¾ç—…)     ~8,000 ä¸ª
â”œâ”€â”€ Symptom    (ç—‡çŠ¶)     ~5,000 ä¸ª
â”œâ”€â”€ Drug       (è¯ç‰©)     ~4,000 ä¸ª
â”œâ”€â”€ Food       (é£Ÿç‰©)     ~3,000 ä¸ª
â”œâ”€â”€ Check      (æ£€æŸ¥é¡¹ç›®)  ~500 ä¸ª
â””â”€â”€ Department (ç§‘å®¤)     ~50 ä¸ª

å…³ç³»ç±»å‹ (Relationships):
â”œâ”€â”€ has_symptom      ç–¾ç—… â†’ ç—‡çŠ¶
â”œâ”€â”€ common_drug      ç–¾ç—… â†’ å¸¸ç”¨è¯ç‰©
â”œâ”€â”€ recommand_drug   ç–¾ç—… â†’ æ¨èè¯ç‰©
â”œâ”€â”€ need_check       ç–¾ç—… â†’ æ£€æŸ¥é¡¹ç›®
â”œâ”€â”€ belongs_to       ç–¾ç—… â†’ ç§‘å®¤
â”œâ”€â”€ do_eat           ç–¾ç—… â†’ å®œåƒé£Ÿç‰©
â”œâ”€â”€ no_eat           ç–¾ç—… â†’ å¿Œåƒé£Ÿç‰©
â”œâ”€â”€ recommand_eat    ç–¾ç—… â†’ æ¨èé£Ÿè°±
â””â”€â”€ acompany_with    ç–¾ç—… â†’ å¹¶å‘ç—‡
```

#### 5. æ™ºèƒ½é—®ç­”æ¥å£

```python
class KnowledgeGraphModule:
    
    def smart_query(self, query):
        """æ™ºèƒ½é—®ç­”ä¸»æµç¨‹"""
        
        # 1. å®ä½“è¯†åˆ«
        entities = self.medical_dict.extract_entities(query)
        
        # 2. æ„å›¾åˆ†ç±»
        intent, confidence = self.intent_classifier.classify(query, entities)
        
        # 3. ç”ŸæˆCypher
        cypher_queries = self.cypher_generator.generate(intent, entities)
        
        # 4. æ‰§è¡ŒæŸ¥è¯¢
        results = []
        for cypher in cypher_queries:
            results.extend(self.graph.run(cypher).data())
        
        # 5. æ„å»ºä¸Šä¸‹æ–‡
        context = self._build_context_from_results(intent, entities, results)
        
        return {
            'entities': entities,
            'intent': intent,
            'results': results,
            'context': context
        }
```

---

## ğŸ­ å››ã€å››ç§ä½¿ç”¨åœºæ™¯

### åœºæ™¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ä½¿ç”¨åœºæ™¯åˆ†å‘                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚                        ç”¨æˆ·è¾“å…¥ï¼ˆè¯­éŸ³/æ–‡å­—ï¼‰                          â”‚
â”‚                               â”‚                                      â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚              â”‚                â”‚                â”‚                    â”‚
â”‚              â–¼                â–¼                â–¼                    â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚       â”‚  è¯­éŸ³å‘½ä»¤  â”‚    â”‚  Session  â”‚    â”‚  æ¨¡å¼é…ç½®  â”‚             â”‚
â”‚       â”‚"æˆ‘æ˜¯æ‚£è€…" â”‚    â”‚   çŠ¶æ€    â”‚    â”‚ (config)  â”‚             â”‚
â”‚       â”‚"æˆ‘æ˜¯åŒ»ç”Ÿ" â”‚    â”‚   ç®¡ç†    â”‚    â”‚           â”‚             â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚              â”‚                â”‚                â”‚                    â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                               â–¼                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                      å¯¹è¯æ¨¡å¼åˆ‡æ¢å™¨                           â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚  â”‚
â”‚   â”‚  â”‚æ‚£è€…æ¨¡å¼  â”‚  â”‚åŒ»ç”Ÿæ¨¡å¼  â”‚  â”‚ä¼šè¯Šæ¨¡å¼  â”‚  â”‚é™ªæŠ¤æ¨¡å¼  â”‚        â”‚  â”‚
â”‚   â”‚  â”‚ patient â”‚  â”‚ doctor  â”‚  â”‚consult. â”‚  â”‚ escort  â”‚        â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### åœºæ™¯ä¸€ï¼šæ‚£è€…æ¨¡å¼ï¼ˆå¯¼è¯Š + å¥åº·å»ºè®®ï¼‰

**æ–‡ä»¶ä½ç½®**: `server/modules/medical/triage.py`

**åŠŸèƒ½**:
- æ™ºèƒ½å¯¼è¯Šï¼šæ ¹æ®ç—‡çŠ¶æ¨èç§‘å®¤å’ŒåŒ»ç”Ÿ
- å¥åº·å»ºè®®ï¼šæä¾›é€šä¿—æ˜“æ‡‚çš„åŒ»ç–—è§£é‡Š

#### åç«¯æ•°æ®åº“ (SQLite)

**æ•°æ®åº“æ–‡ä»¶**: `server/data/hospital.db`

**åˆå§‹åŒ–è„šæœ¬**: `server/data/init_hospital_db.py`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SQLite åŒ»é™¢æ•°æ®åº“ç»“æ„                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     departments è¡¨                           â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  id (PK)    â”‚ name     â”‚ keywords                           â”‚   â”‚
â”‚   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
â”‚   â”‚  'neuro'    â”‚ ç¥ç»å†…ç§‘  â”‚ å¤´ç—›,å¤´æ™•,åå¤´ç—›,å¤±çœ ,çœ©æ™•...       â”‚   â”‚
â”‚   â”‚  'cardio'   â”‚ å¿ƒå†…ç§‘    â”‚ èƒ¸ç—›,å¿ƒæ‚¸,å¿ƒæ…Œ,èƒ¸é—·,æ°”çŸ­...         â”‚   â”‚
â”‚   â”‚  'gastro'   â”‚ æ¶ˆåŒ–å†…ç§‘  â”‚ è…¹ç—›,è…¹æ³»,ä¾¿ç§˜,æ¶å¿ƒ,å‘•å...         â”‚   â”‚
â”‚   â”‚  ...        â”‚ ...      â”‚ ...                                 â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â”‚ 1:N                                   â”‚
â”‚                              â–¼                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      doctors è¡¨                              â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  id â”‚ name â”‚ department_id â”‚ title    â”‚ specialty â”‚ room   â”‚   â”‚
â”‚   â”‚â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
â”‚   â”‚  1  â”‚ å¼ æ˜ â”‚ neuro         â”‚ ä¸»ä»»åŒ»å¸ˆ â”‚ è„‘è¡€ç®¡ç–¾ç—… â”‚ A301   â”‚   â”‚
â”‚   â”‚  2  â”‚ ç‹å â”‚ neuro         â”‚ å‰¯ä¸»ä»»åŒ»å¸ˆâ”‚ ç™«ç—«     â”‚ A302   â”‚   â”‚
â”‚   â”‚  3  â”‚ æä¼Ÿ â”‚ cardio        â”‚ ä¸»æ²»åŒ»å¸ˆ â”‚ å† å¿ƒç—…   â”‚ B201   â”‚   â”‚
â”‚   â”‚  ...â”‚ ...  â”‚ ...           â”‚ ...      â”‚ ...       â”‚ ...    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                      â”‚
â”‚   å­—æ®µè¯´æ˜:                                                          â”‚
â”‚   â€¢ experience_years: ä»ä¸šå¹´é™ (ç”¨äºèŒç§°æƒé‡)                        â”‚
â”‚   â€¢ current_queue: å½“å‰æ’é˜Ÿäººæ•° (åŠ¨æ€æ›´æ–°)                           â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ•°æ®åº“è¡¨ç»“æ„**:

```sql
-- ç§‘å®¤è¡¨
CREATE TABLE departments (
    id TEXT PRIMARY KEY,          -- ç§‘å®¤ID (å¦‚ 'neuro', 'cardio')
    name TEXT NOT NULL,           -- ç§‘å®¤åç§° (å¦‚ 'ç¥ç»å†…ç§‘')
    keywords TEXT                 -- ç—‡çŠ¶å…³é”®è¯ (é€—å·åˆ†éš”)
);

-- åŒ»ç”Ÿè¡¨  
CREATE TABLE doctors (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,           -- åŒ»ç”Ÿå§“å
    department_id TEXT,           -- æ‰€å±ç§‘å®¤ID (å¤–é”®)
    title TEXT,                   -- èŒç§° (ä¸»ä»»åŒ»å¸ˆ/å‰¯ä¸»ä»»/ä¸»æ²»/ä½é™¢)
    specialty TEXT,               -- æ“…é•¿ç–¾ç—…
    room TEXT,                    -- è¯Šå®¤å· (å¦‚ 'A301')
    experience_years INTEGER,     -- ä»ä¸šå¹´é™
    current_queue INTEGER DEFAULT 0,  -- å½“å‰æ’é˜Ÿäººæ•°
    FOREIGN KEY (department_id) REFERENCES departments(id)
);
```

**é¢„ç½®æ•°æ®è§„æ¨¡**:

| è¡¨ | è®°å½•æ•° | è¯´æ˜ |
|:---|:---:|:---|
| departments | 20 | ç¥ç»å†…ç§‘ã€å¿ƒå†…ç§‘ã€æ¶ˆåŒ–å†…ç§‘ã€å‘¼å¸å†…ç§‘ç­‰ |
| doctors | 60-100 | æ¯ç§‘å®¤3-5ååŒ»ç”Ÿï¼Œéšæœºç”Ÿæˆ |

**ç§‘å®¤åˆ—è¡¨**:

| ID | ç§‘å®¤åç§° | ç—‡çŠ¶å…³é”®è¯ç¤ºä¾‹ |
|:---|:---|:---|
| neuro | ç¥ç»å†…ç§‘ | å¤´ç—›, å¤´æ™•, åå¤´ç—›, å¤±çœ , çœ©æ™• |
| cardio | å¿ƒå†…ç§‘ | èƒ¸ç—›, å¿ƒæ‚¸, å¿ƒæ…Œ, èƒ¸é—·, æ°”çŸ­ |
| gastro | æ¶ˆåŒ–å†…ç§‘ | è…¹ç—›, è…¹æ³», ä¾¿ç§˜, æ¶å¿ƒ, å‘•å |
| resp | å‘¼å¸å†…ç§‘ | å’³å—½, å’³ç—°, æ°”å–˜, å‘¼å¸å›°éš¾ |
| endo | å†…åˆ†æ³Œç§‘ | å¤šé¥®, å¤šå°¿, è‚¥èƒ–, ç³–å°¿ç—… |
| derm | çš®è‚¤ç§‘ | çš®ç–¹, ç˜™ç—’, çº¢è‚¿, ç—¤ç–® |
| ortho | éª¨ç§‘ | éª¨æŠ˜, æ‰­ä¼¤, è…°ç—›, é¢ˆæ¤ç—› |
| psych | ç²¾ç¥ç§‘ | ç„¦è™‘, æŠ‘éƒ, å¤±çœ , æƒ…ç»ªä½è½ |
| pedi | å„¿ç§‘ | å°å„¿å‘çƒ­, å°å„¿å’³å—½, å°å„¿è…¹æ³» |
| emergency | æ€¥è¯Šç§‘ | å‰§çƒˆç–¼ç—›, å¤§å‡ºè¡€, å‘¼å¸å›°éš¾ |

**æ ¸å¿ƒæµç¨‹**:

```python
class TriageService:
    
    def analyze(self, user_input, age=None, gender=None):
        """æ‚£è€…å¯¼è¯Šä¸»æµç¨‹"""
        
        # 1. ç—‡çŠ¶æå–ï¼ˆåŒ»å­¦è¯å…¸ + å…³é”®è¯åŒ¹é…ï¼‰
        symptoms = self._extract_symptoms(user_input)
        
        # 2. RAG + LLM ç§‘å®¤åŒ¹é…
        dept_result = self._match_department_with_llm(user_input, symptoms)
        department = dept_result.get('department', {})
        diseases = dept_result.get('diseases', [])
        
        # 3. å¤šå› ç´ æŠ•ç¥¨æ¨èåŒ»ç”Ÿ
        doctors = self._recommend_doctors_voting(
            department['id'],
            diseases,
            top_k=3
        )
        
        # 4. ç”Ÿæˆå¯¼è¯Šå›å¤
        response = self._generate_response(
            symptoms, department, diseases, doctors
        )
        
        return {
            'department': department,
            'diseases': diseases,
            'doctors': doctors,
            'response': response
        }
```

**åŒ»ç”Ÿæ¨èæŠ•ç¥¨æœºåˆ¶**:

```python
def _calculate_doctor_score(self, doctor, diseases):
    """å¤šå› ç´ æŠ•ç¥¨è®¡ç®—åŒ»ç”Ÿå¾—åˆ†"""
    score = 0.0
    
    # 1. æ“…é•¿ç–¾ç—…åŒ¹é…ï¼š40%
    specialty = doctor.get('specialty', '')
    for disease in diseases:
        if disease in specialty:
            score += 0.40
            break
    
    # 2. èŒç§°ç»éªŒï¼š30%
    title_weights = {
        'ä¸»ä»»åŒ»å¸ˆ': 1.0,
        'å‰¯ä¸»ä»»åŒ»å¸ˆ': 0.8,
        'ä¸»æ²»åŒ»å¸ˆ': 0.6,
        'ä½é™¢åŒ»å¸ˆ': 0.4
    }
    score += 0.30 * title_weights.get(doctor['title'], 0.3)
    
    # 3. æ’é˜Ÿäººæ•°å°‘ï¼š30%
    queue_score = max(0, 1 - doctor['queue'] / 20)
    score += 0.30 * queue_score
    
    return score
```

---

### åœºæ™¯äºŒï¼šåŒ»ç”Ÿæ¨¡å¼ï¼ˆè¾…åŠ©è¯Šæ–­ï¼‰

**æ–‡ä»¶ä½ç½®**: `server/modules/medical/diagnosis_assistant.py`

**åŠŸèƒ½**:
- ä¸“ä¸šæœ¯è¯­ä½¿ç”¨
- é‰´åˆ«è¯Šæ–­å»ºè®®
- æ¨èæ£€æŸ¥é¡¹ç›®
- å±æ€¥ç—‡çŠ¶é¢„è­¦

**æ ¸å¿ƒæµç¨‹**:

```python
class DiagnosisAssistant:
    
    # ç´§æ€¥ç—‡çŠ¶å…³é”®è¯
    emergency_keywords = [
        'å‰§çƒˆç–¼ç—›', 'å¤§é‡å‡ºè¡€', 'å‘¼å¸å›°éš¾', 'æ„è¯†ä¸æ¸…', 
        'å¿ƒæ¢—', 'è„‘æ¢—', 'è„‘å‡ºè¡€', 'çª’æ¯', 'å¿ƒè„éª¤åœ'
    ]
    
    def diagnose(self, query, symptoms=None, patient_info=None):
        """åŒ»ç”Ÿè¾…åŠ©è¯Šæ–­"""
        
        # 1. RAG çŸ¥è¯†æ£€ç´¢
        rag_context = self.rag_module.build_context(query, top_k=5)
        
        # 2. æ„å»ºä¸“ä¸šè¯Šæ–­ Prompt
        system_prompt = """ä½ æ˜¯ä¸€ä½èµ„æ·±çš„ä¸´åºŠåŒ»ç”ŸåŠ©æ‰‹ã€‚
        ä½¿ç”¨ä¸“ä¸šåŒ»å­¦æœ¯è¯­ï¼Œæä¾›ï¼š
        - å¯èƒ½çš„è¯Šæ–­
        - é‰´åˆ«è¦ç‚¹
        - å»ºè®®æ£€æŸ¥
        - å¤„ç†å»ºè®®
        æœ€åæé†’è¿™åªæ˜¯è¾…åŠ©å»ºè®®ã€‚"""
        
        # 3. LLM ç”Ÿæˆè¯Šæ–­å»ºè®®
        response = self.dialogue_module.chat(
            query=f"å‚è€ƒèµ„æ–™ï¼š{rag_context}\n{query}",
            system_prompt=system_prompt,
            use_rag=False
        )
        
        # 4. å±æ€¥æƒ…å†µæ£€æµ‹
        warning = self._check_emergency(query)
        
        return {
            'response': response['response'],
            'rag_used': bool(rag_context),
            'warning': warning  # å¦‚æœ‰ç´§æ€¥æƒ…å†µ
        }
```

---

### åœºæ™¯ä¸‰ï¼šä¼šè¯Šæ¨¡å¼ï¼ˆSOAPç—…å†ç”Ÿæˆï¼‰

**æ–‡ä»¶ä½ç½®**: `server/modules/aci/soap_generator.py`

**åŠŸèƒ½**:
- å®æ—¶å¯¹è¯è®°å½•
- ä¸´åºŠå®ä½“è‡ªåŠ¨æå–
- SOAPæ ¼å¼ç—…å†ç”Ÿæˆ
- æºé”šç‚¹è¿½æº¯

**SOAPç—…å†ç»“æ„**:

```python
@dataclass
class SOAPNote:
    """SOAP ç—…å†ç»“æ„"""
    session_id: str
    generated_at: datetime
    
    # S - Subjectiveï¼ˆä¸»è¯‰ï¼‰
    subjective: {
        'chief_complaint': str,       # ä¸»è¯‰
        'history_present_illness': str,  # ç°ç—…å²
        'symptoms': List[str],        # ç—‡çŠ¶åˆ—è¡¨
        'past_history': str,          # æ—¢å¾€å²
        'allergy_history': str        # è¿‡æ•å²
    }
    
    # O - Objectiveï¼ˆå®¢è§‚æ£€æŸ¥ï¼‰
    objective: {
        'vital_signs': str,           # ç”Ÿå‘½ä½“å¾
        'physical_exam': str,         # ä½“æ ¼æ£€æŸ¥
        'test_results': str           # æ£€æŸ¥ç»“æœ
    }
    
    # A - Assessmentï¼ˆè¯„ä¼°ï¼‰
    assessment: {
        'diagnoses': List[str],       # è¯Šæ–­
        'differential': List[str],    # é‰´åˆ«è¯Šæ–­
        'severity': str               # ä¸¥é‡ç¨‹åº¦
    }
    
    # P - Planï¼ˆè®¡åˆ’ï¼‰
    plan: {
        'medications': List[str],     # è¯ç‰©
        'procedures': List[str],      # æ£€æŸ¥/æ²»ç–—
        'follow_up': str,             # éšè®¿è®¡åˆ’
        'instructions': str           # åŒ»å˜±
    }
```

**ç”Ÿæˆæµç¨‹**:

```python
class SOAPGenerator:
    
    def generate_soap(self, session):
        """ä»ä¼šè¯Šå¯¹è¯ç”Ÿæˆ SOAP ç—…å†"""
        
        # 1. è·å–å¯¹è¯è½¬å½•
        transcript = session.get_transcript(
            include_roles=True,
            include_timestamps=True
        )
        
        # 2. å®ä½“æå–
        entities = self._extract_all_entities(session)
        # {symptoms, diseases, medications, procedures, body_parts, time}
        
        # 3. LLM ç”Ÿæˆ SOAP
        soap = self._generate_with_llm(session, transcript, entities)
        
        # 4. æ·»åŠ æºé”šç‚¹ï¼ˆé“¾æ¥åˆ°åŸå§‹å¯¹è¯ï¼‰
        self._add_source_anchors(soap, session)
        
        # 5. éªŒè¯å†…å®¹ï¼ˆå¹»è§‰æ£€æµ‹ï¼‰
        soap.verification = self.verifier.verify_soap(soap, session)
        
        return soap
```

**è¾“å‡ºç¤ºä¾‹**:

```markdown
# SOAP ç—…å†ç¬”è®°

**ç”Ÿæˆæ—¶é—´**: 2026-01-09 11:30:00
**ä¼šè¯ID**: session_001

## æ‚£è€…ä¿¡æ¯
- **å§“å**: å¼ ä¸‰
- **å¹´é¾„**: 45
- **æ€§åˆ«**: ç”·

## S - ä¸»è¯‰ (Subjective)
**ä¸»è¯‰**: èƒ¸é—·ç—›ä¸¤å¤©
**ç°ç—…å²**: æ‚£è€…è‡ªè¯‰èƒ¸å£æœ‰ç‚¹é—·ç—›ï¼Œå·²ç»ä¸¤å¤©äº†ï¼Œé˜µå‘æ€§ï¼Œæ´»åŠ¨ååŠ é‡ï¼Œä¼‘æ¯åç¼“è§£ã€‚
**ç—‡çŠ¶**: èƒ¸é—·, èƒ¸ç—›

## O - å®¢è§‚æ£€æŸ¥ (Objective)
**æ£€æŸ¥ç»“æœ**: å¿ƒç”µå›¾, å¿ƒè„å½©è¶…

## A - è¯„ä¼° (Assessment)
**è¯Šæ–­**: é«˜è¡€å‹
**é‰´åˆ«è¯Šæ–­**: å† å¿ƒç—…, å¿ƒç»ç—›

## P - è®¡åˆ’ (Plan)
**è¯ç‰©æ²»ç–—**:
  - ç¡è‹¯åœ°å¹³
**æ£€æŸ¥/æ²»ç–—**: å¿ƒç”µå›¾, å¿ƒè„å½©è¶…
```

---

### åœºæ™¯å››ï¼šé™ªæŠ¤æ¨¡å¼ï¼ˆæƒ…æ„Ÿå¯¹è¯ï¼‰

**æ–‡ä»¶ä½ç½®**: `server/modules/nlp/emotion_response_strategy.py`

**åŠŸèƒ½**:
- 13ç§æƒ…æ„Ÿè¯†åˆ«ä¸å“åº”
- æƒ…æ„Ÿé£æ ¼åŒ–è¯­éŸ³åˆæˆæŒ‡ä»¤
- åŒç†å¿ƒå¯¹è¯ç”Ÿæˆ

**æƒ…æ„Ÿæ˜ å°„**:

```python
class EmotionResponseStrategy:
    
    # ç”¨æˆ·æƒ…ç»ª â†’ AIå›å¤é£æ ¼æ˜ å°„
    EMOTION_TO_STYLE = {
        # åŸºç¡€æƒ…æ„Ÿï¼ˆ6ç§ï¼‰
        "sad":      "ç”¨æ¸©æš–å…³æ€€çš„è¯­æ°”ï¼Œè¯­é€Ÿç¨æ…¢ï¼Œè¡¨è¾¾ç†è§£å’ŒåŒæƒ…",
        "angry":    "ç”¨å¹³é™ä¸“ä¸šçš„è¯­æ°”ï¼Œè¯­é€Ÿé€‚ä¸­ï¼Œè€å¿ƒå€¾å¬ä¸äº‰è¾©",
        "fear":     "ç”¨å¹³ç¨³å®‰å¿ƒçš„è¯­æ°”ï¼Œè¯­é€Ÿç¨æ…¢ï¼Œç»™äºˆè‚¯å®šå’Œæ”¯æŒ",
        "happy":    "ç”¨è½»æ¾æ„‰å¿«çš„è¯­æ°”ï¼Œè¯­é€Ÿç¨å¿«ï¼Œä¿æŒç§¯ææ°›å›´",
        "surprise": "ç”¨æ¸…æ™°æ˜äº†çš„è¯­æ°”ï¼Œè¯­é€Ÿé€‚ä¸­ï¼Œç®€æ´è§£é‡Šæƒ…å†µ",
        "neutral":  "ç”¨ä¸“ä¸šå‹å¥½çš„è¯­æ°”ï¼Œè¯­é€Ÿé€‚ä¸­ï¼Œæ€åº¦äº²åˆ‡",
        
        # æ‰©å±•æƒ…æ„Ÿï¼ˆ7ç§åŒ»ç–—åœºæ™¯å¸¸è§æƒ…æ„Ÿï¼‰
        "depressed":  "ç”¨æ·±åº¦å…±æƒ…çš„è¯­æ°”ï¼Œè¯­é€Ÿç¼“æ…¢ï¼Œé¼“åŠ±å¯»æ±‚å¸®åŠ©",
        "anxious":    "ç”¨èˆ’ç¼“é•‡å®šçš„è¯­æ°”ï¼Œè¯­é€Ÿå¹³ç¨³ï¼Œé€æ­¥å¼•å¯¼æ”¾æ¾",
        "pain":       "ç”¨æ¸©å’Œå…³å¿ƒçš„è¯­æ°”ï¼Œè¯­é€Ÿç¨æ…¢ï¼Œå»ºè®®å°±åŒ»",
        "confused":   "ç”¨æ¸…æ™°è€å¿ƒçš„è¯­æ°”ï¼Œè¯­é€Ÿé€‚ä¸­ï¼Œç®€æ´æ˜“æ‡‚",
        "grateful":   "ç”¨æ¸©é¦¨å‹å¥½çš„è¯­æ°”ï¼Œè¯­é€Ÿé€‚ä¸­ï¼Œä¿æŒæ­£é¢äº’åŠ¨",
        "frustrated": "ç”¨ç†è§£åŒ…å®¹çš„è¯­æ°”ï¼Œè¯­é€Ÿé€‚ä¸­ï¼Œç§¯æè§£å†³é—®é¢˜",
        "tired":      "ç”¨å…³åˆ‡ä½“è´´çš„è¯­æ°”ï¼Œè¯­é€Ÿç¨æ…¢ï¼Œå»ºè®®ä¼‘æ¯",
    }
```

**æƒ…æ„Ÿæ„ŸçŸ¥å¯¹è¯æµç¨‹**:

```python
def build_emotional_system_prompt(self, emotion, base_prompt=None):
    """æ„å»ºæƒ…æ„Ÿæ„ŸçŸ¥çš„ System Prompt"""
    
    style_hint = self.EMOTION_TO_STYLE.get(emotion, self.EMOTION_TO_STYLE["neutral"])
    
    return f"""
    ä½ æ˜¯ä¸€ä¸ªå¯Œæœ‰åŒç†å¿ƒçš„åŒ»ç–—è¯­éŸ³åŠ©æ‰‹ã€‚ç”¨æˆ·å½“å‰çš„æƒ…ç»ªæ˜¯ã€{emotion}ã€‘ã€‚
    
    æ¨èçš„å›å¤é£æ ¼æ˜¯ï¼š{style_hint}
    
    ã€è¾“å‡ºæ ¼å¼è¦æ±‚ã€‘ï¼š
    ä½ çš„å›å¤å¿…é¡»åŒ…å«ä¸¤éƒ¨åˆ†ï¼Œç”¨ <endofprompt> åˆ†éš”ï¼š
    1. æ–¹æ‹¬å·å†…çš„é£æ ¼æè¿°ï¼ˆ8-15ä¸ªä¸­æ–‡å­—ï¼‰
    2. å®é™…å›å¤å†…å®¹
    
    ç¤ºä¾‹ï¼š
    [æ¸©æš–å…³æ€€çš„è¯­æ°”ï¼Œè¯­é€Ÿç¨æ…¢]<endofprompt>æˆ‘ç†è§£ä½ çš„æ„Ÿå—ï¼Œèº«ä½“ä¸èˆ’æœè®©äººå¾ˆæ‹…å¿ƒã€‚
    """

def parse_emotional_response(self, llm_output):
    """è§£æ LLM çš„æƒ…æ„Ÿæ„ŸçŸ¥è¾“å‡º"""
    
    # æ ¼å¼ï¼š[é£æ ¼æè¿°]<endofprompt>[å›å¤å†…å®¹]
    if "<endofprompt>" in llm_output:
        parts = llm_output.split("<endofprompt>", 1)
        style = re.search(r'\[([^\]]+)\]', parts[0]).group(1)
        content = parts[1].strip()
        return {"style": style, "content": content}
```

---

## ğŸ”§ é…ç½®æ±‡æ€»

**å®Œæ•´é…ç½®ç¤ºä¾‹** (`config/config.yaml`):

```yaml
# å¯¹è¯ç³»ç»Ÿé…ç½®
dialogue:
  provider: "gptq"  # transformers | gguf | gptq
  gptq_model_path: "server/models/gptq/qwen3-8b-sft-huatuo-quant-w4a16"
  max_length: 512
  temperature: 0.7
  top_p: 0.9
  history_length: 10
  system_prompt: |
    ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„åŒ»ç–—è¯­éŸ³åŠ©æ‰‹...

# RAGé…ç½®
rag:
  enabled: true
  embedding_model: "BAAI/bge-small-zh-v1.5"
  index_path: "data/rag_index"
  top_k: 3
  min_score: 0.6

# çŸ¥è¯†å›¾è°±é…ç½®
knowledge_graph:
  enabled: true
  host: "localhost"
  port: 7474
  user: "neo4j"
  password: "12345678"
```

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|:---|:---:|:---|
| RAGæ£€ç´¢å»¶è¿Ÿ | <100ms | FAISSå‘é‡æ£€ç´¢ |
| çŸ¥è¯†å›¾è°±æŸ¥è¯¢ | <200ms | Neo4j Cypheræ‰§è¡Œ |
| LLMæ¨ç†ï¼ˆGPTQ 8Bï¼‰ | ~1.5s | 512 tokenç”Ÿæˆ |
| å¯¼è¯Šå“åº” | <2s | å®Œæ•´å¯¼è¯Šæµç¨‹ |
| SOAPç”Ÿæˆ | <3s | ç—…å†ç”Ÿæˆ+éªŒè¯ |

---

## ğŸ¯ æŠ€æœ¯äº®ç‚¹æ€»ç»“

1. **å¤šæ–¹æ¡ˆLLMæ”¯æŒ**ï¼š0.5B/4B/8Bä¸‰ç§è§„æ¨¡ï¼ŒGGUF/GPTQä¸¤ç§é‡åŒ–ï¼Œé€‚é…ä¸åŒç¡¬ä»¶
2. **çŸ¥è¯†å›¾è°±ä¼˜å…ˆç­–ç•¥**ï¼šç»“æ„åŒ–çŸ¥è¯†ä¼˜å…ˆï¼Œå‘é‡æ£€ç´¢å…œåº•ï¼Œæé«˜å›ç­”å‡†ç¡®æ€§
3. **åŒ»å­¦NLUå…¨æµç¨‹**ï¼šåŒ»å­¦è¯å…¸ â†’ æ„å›¾åˆ†ç±» â†’ Cypherç”Ÿæˆï¼Œå…¨é“¾è·¯è‡ªç ”
4. **å››ç§å·®å¼‚åŒ–åœºæ™¯**ï¼šæ‚£è€…/åŒ»ç”Ÿ/ä¼šè¯Š/é™ªæŠ¤ï¼Œé’ˆå¯¹æ€§Promptå’ŒåŠŸèƒ½è®¾è®¡
5. **æƒ…æ„Ÿæ„ŸçŸ¥å¯¹è¯**ï¼š13ç§æƒ…æ„Ÿæ˜ å°„ï¼Œå½±å“è¯­éŸ³åˆæˆé£æ ¼

---

*æ–‡æ¡£æœ€åæ›´æ–°: 2026-01-09*


åŒ»ç”Ÿï¼šæ‚¨å¥½ï¼Œè¯·é—®ä»Šå¤©å“ªé‡Œä¸èˆ’æœï¼Ÿ
æ‚£è€…ï¼šåŒ»ç”Ÿæ‚¨å¥½ï¼Œæˆ‘æœ€è¿‘ä¸‰å¤©ä¸€ç›´å¤´ç—›ï¼Œå·¦è¾¹å¤ªé˜³ç©´çš„ä½ç½®ï¼Œèƒ€ç—›çš„æ„Ÿè§‰ã€‚
åŒ»ç”Ÿï¼šç–¼ç—›æ˜¯æŒç»­æ€§çš„è¿˜æ˜¯é˜µå‘æ€§çš„ï¼Ÿ
æ‚£è€…ï¼šé˜µå‘æ€§çš„ï¼Œæ¯æ¬¡æŒç»­å¤§æ¦‚åŠå°æ—¶åˆ°ä¸€å°æ—¶ã€‚
å®¶å±ï¼šä»–è¿˜æœ‰ç‚¹å‘çƒ­ï¼Œæ˜¨æ™šä½“æ¸©ä¸‰åå…«åº¦äº”ã€‚
åŒ»ç”Ÿï¼šæœ‰æ²¡æœ‰æ¶å¿ƒã€å‘•åæˆ–è€…è§†ç‰©æ¨¡ç³Šï¼Ÿ
æ‚£è€…ï¼šæœ‰ç‚¹æ¶å¿ƒï¼Œä½†æ²¡åã€‚
åŒ»ç”Ÿï¼šå¥½çš„ï¼Œæˆ‘å…ˆç»™æ‚¨æµ‹ä¸€ä¸‹è¡€å‹å’Œä½“æ¸©ã€‚
åŒ»ç”Ÿï¼šä½“æ¸©ä¸‰åå…«åº¦ä¸‰ï¼Œè¡€å‹ä¸€ç™¾ä¸‰åäº”æ¯”å…«åäº”æ¯«ç±³æ±æŸ±ï¼Œç¨å¾®åé«˜ã€‚
åŒ»ç”Ÿï¼šæˆ‘å†æ£€æŸ¥ä¸€ä¸‹ï¼Œçœ‹çœ‹å–‰å’™ã€‚å—¯ï¼Œå’½éƒ¨å……è¡€ï¼Œæ‰æ¡ƒä½“ä¸€åº¦è‚¿å¤§ã€‚
åŒ»ç”Ÿï¼šé¢ˆéƒ¨æ·‹å·´ç»“æœ‰è½»åº¦è‚¿å¤§ï¼Œæ— å‹ç—›ã€‚ç³å­”ç­‰å¤§ç­‰åœ†ï¼Œå¯¹å…‰åå°„çµæ•ã€‚
åŒ»ç”Ÿï¼šæ ¹æ®æ‚¨çš„ç—‡çŠ¶å’Œä½“æ ¼æ£€æŸ¥ï¼Œåˆæ­¥è¯Šæ–­æ˜¯ä¸Šå‘¼å¸é“æ„ŸæŸ“å¼•èµ·çš„å‘çƒ­æ€§å¤´ç—›ã€‚
åŒ»ç”Ÿï¼šéœ€è¦æ’é™¤çš„æœ‰åå¤´ç—›å’Œé«˜è¡€å‹æ€§å¤´ç—›ï¼Œå»ºè®®åšä¸€ä¸ªå¤´é¢…CTæ£€æŸ¥æ’é™¤å™¨è´¨æ€§ç—…å˜ã€‚
åŒ»ç”Ÿï¼šæ²»ç–—æ–¹æ¡ˆæ˜¯å£æœå¸ƒæ´›èŠ¬ç¼“é‡Šç‰‡ï¼Œä¸€æ¬¡ä¸€ç‰‡ï¼Œä¸€æ—¥ä¸¤æ¬¡ï¼Œé€€çƒ­æ­¢ç—›ã€‚
åŒ»ç”Ÿï¼šåŒæ—¶æœç”¨æ„Ÿå†’çµé¢—ç²’ï¼Œä¸€æ¬¡ä¸€è¢‹ï¼Œä¸€æ—¥ä¸‰æ¬¡ï¼Œé¥­åæœç”¨ã€‚
åŒ»ç”Ÿï¼šå¤šå–æ°´ï¼Œæ³¨æ„ä¼‘æ¯ï¼Œé¥®é£Ÿæ¸…æ·¡ã€‚ä¸‰å¤©åå¤è¯Šï¼Œå¦‚æœ‰å¤´ç—›åŠ é‡æˆ–è§†åŠ›æ¨¡ç³Šç«‹å³å°±åŒ»ã€‚
æ‚£è€…ï¼šå¥½çš„ï¼Œè°¢è°¢åŒ»ç”Ÿã€‚